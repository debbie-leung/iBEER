---
title: "Physiology"
author: "Debbie Leung"
date: "2/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Set up
```{r}
# install.packages(c("ggplot2", "dplyr", "tidyr", "gridExtra"))
install.packages("cowplot")
library(ggplot2)
library(dplyr)
library(tidyr)
library(gridExtra)
library(cowplot)
```

```{r}
mydata <- read.csv("physiology_data.csv", stringsAsFactors = FALSE) %>% na_if("")
df <- data.frame(mydata)
```

## Summary Statistics

```{r}
summary(df)
```
```{r}
str(df)
```

## Exploratory Figures

### Heart Rate
Generally confused the different combinations of plots I can literally plot by selecting the different factor variables. Also arrangement styles.
```{r}
# Compare box and violin plots
hr <- df %>% drop_na(heart_rate) # drop NA for heart rate, simultaneously filtering for H and L only

ggplot(data = hr, aes(x = heating_rate, y = heart_rate, fill=time_point)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + ggtitle("Boxplot of Heart Rate by Heating Rate") 

ggplot(data = hr, aes(x = heating_rate, y = heart_rate, , fill=time_point)) + geom_violin() + geom_jitter() + ggtitle("Violin Plot of Heart Rate by Heating Rate")

# grid.arrange(hr_box, hr_violin, ncol = 2)
```

```{r}
# Compare high and low tidal heights at different time points

# Change to long pivot
hr_long <- hr %>% unite("rate_time", c("heating_rate", "time_point"), sep = "_", remove = FALSE)

hr_long <- within(hr_long, rm("heating_rate", "time_point"))

ggplot(data = hr_long, aes(x = rate_time, y = heart_rate, fill=tidal_height)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + ggtitle("Boxplot of shore heights against warming rate at different time points") + theme(axis.text.x = element_text(angle=45, hjust=1)) + labs(x = "heating rate at different time points")

# Can further split this into one with two time points side-by-side or two shore heights at different time points

```

### Osmolality

```{r}
osmo <- df %>% drop_na(osmolality)

osmo <- osmo %>% drop_na(time_point) # remove dummy controls with D

osmo <- subset(osmo, time_point == "T1" | time_point == "T2" | time_point == "T0_air" | time_point == "T0_water") # remove controls with T1_F/M/S or T2_F/M/S

ggplot(data = osmo, aes(x = heating_rate, y = osmolality, fill=time_point)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + ggtitle("Boxplot of Osmolality by Heating Rate")

ggplot(data = osmo, aes(x = heating_rate, y = osmolality, fill=tidal_height)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + ggtitle("Boxplot of Osmolality by Heating Rate")
```
Seems to have two outliers but I can only find one. Also every time I try to reproduce the graph, the two dots move position?!

Also not plotting seawater osmolality...

```{r}
# Compare high and low tidal heights at different time points

# Change to long pivot
osmo_long <- osmo %>% unite("rate_time", c("heating_rate", "time_point"), sep = "_", remove = FALSE)

osmo_long <- within(osmo_long, rm("heating_rate", "time_point"))

ggplot(data = osmo_long, aes(x = rate_time, y = osmolality, fill=tidal_height)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + ggtitle("Boxplot of shore heights against warming rate at different time points") + theme(axis.text.x = element_text(angle=45, hjust=1)) + labs(x = "heating rate at different time points")

```
```{r}
# Further split this into one with two time points side-by-side or two shore heights at different time points
osmo_t0 <- subset(osmo, time_point == "T0_air" | time_point == "T0_water")
osmo_t1 <- subset(osmo, time_point == "T1")
osmo_t2 <- subset(osmo, time_point == "T2")

# Split side-by-side graphs: https://stackoverflow.com/questions/1249548/side-by-side-plots-with-ggplot2
# par(mfrow=c(1,2))  
plot_t0 <-ggplot(data = osmo_t0, aes(x = heating_rate, y = osmolality, fill=tidal_height)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + theme(axis.text.x = element_text(angle=45, hjust=1)) + labs(x = "heating rate at T0")

plot_t1 <- ggplot(data = osmo_t1, aes(x = heating_rate, y = osmolality, fill=tidal_height)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + theme(axis.text.x = element_text(angle=45, hjust=1)) + labs(x = "heating rate at T1")

plot_t2 <- ggplot(data = osmo_t2, aes(x = heating_rate, y = osmolality, fill=tidal_height)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + theme(axis.text.x = element_text(angle=45, hjust=1)) + labs(x = "heating rate at T2")

# grid.arrange(plot_t0, plot_t1, plot_t2, ncol=3)
plot_grid(plot_t1, plot_t2, plot_t0, labels = "AUTO")

```
```{r}
osmo_h <- subset(osmo, tidal_height = "H")
osmo_l <- subset(osmo, tidal_height = "L")
  
plot_h <- ggplot(data = osmo_h, aes(x = heating_rate, y = osmolality, fill=time_point)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + theme(axis.text.x = element_text(angle=45, hjust=1)) + labs(x = "heating rate of high tide")

plot_l <- ggplot(data = osmo_l, aes(x = heating_rate, y = osmolality, fill=time_point)) + stat_boxplot(geom = "errorbar") + geom_boxplot() + geom_jitter() + theme(axis.text.x = element_text(angle=45, hjust=1)) + labs(x = "heating rate of low tide")

# grid.arrange(plot_t0, plot_t1, plot_t2, ncol=3)
plot_grid(plot_h, plot_l, labels = "AUTO")  

```

### Weight Loss

```{r}

```


### Thermal Equilibrium

```{r}

```


### Random Variables
How to check for dependent relationship between random variables and response variables?
Check for effects of experimental day?

```{r}
# Check for positive relationship between shell length and average body weight
# Difference between geom_point() and geom_jitter()?

shell_weight <- df %>% drop_na(average_weight)
```


## Publication Figures

Should we do any PCA diagram to group all the variables?

## Statistical Tests
